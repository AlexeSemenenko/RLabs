---
output: html_document
---
#Лабораторный практикум ВКИАД c R

**Преподаватель**
```
Дернакова Оксана Владимировна
```
**Студент**
```
Семененко Алексей Викторович, 2 курс, 6 группа, ПМ
```
**Вариант № 5**


### Часть 1. Управление данными в R

Загрузка данных из текстового файла в таблицу данных

```{r}
qc <- read.table("QC5.txt")
```

Размерность таблицы

```{r}
dim(qc)
```

Первые три записи из таблицы

```{r}
head(qc, 3)
```

Таблица после переименования переменных

```{r}
colnames(qc) <- c("c1", "kit", "nbug", "maker", "vendor", "c2", "c3", "c4", "bug")
head(qc)
```

Комплексная статистика по переменной vendor
 
```{r}
summary(qc$vendor)
```

Комплексная статистика по переменной vendor после ее преобразования в переменную-фактор 

```{r}
qc[, "vendor"] <- as.factor(qc[, "vendor"])
summary(qc[, "vendor"])
```

Число изделий, у которых количество некритических дефектов больше 3

```{r}
sum(qc$nbug > 3)
```

Наблюдения, для которых количество некритических дефектов равно максимальному  

```{r}
qc[qc$nbug == max(qc$nbug),]
```


### Часть 2. Описательная статистика и графический анализ

Присоединение таблицы данных к списку текущих переменных и загрузка дополнительной библиотеки

```{r}
attach(qc)
library("e1071")
```

Выборочные среднее и медиана для переменной с1 в указанном порядке  

```{r}
mean(c1)
median(c1)
```

Выборочные квартили Q1,Q2,Q3, а также интерквартильный размах для переменной c1
 
```{r}
quantile(c1, probs = c(0.25, 0.5, 0.75))
IQR(c1)
```

Комплексная статистика по переменной c1

```{r}
summary(c1)
```

Дисперсия для переменной с1 и переменной 2 * с1 + 100

```{r}
var(c1)
var(2 * c1 + 100)
```
**ВЫВОД**: Вторая дисперсия больше первой в 4 раза

Дисперсия для переменной с1, полученная с помощью векторного выражения

```{r}
sum(mean(c1 * c1) - (mean(c1))^2) * length(c1) / (length(c1) - 1)
```

Гистограмма для переменной с1   

```{r}
hist(c1)
```

Асимметрия и эксцесс для переменной c1 в указанном порядке 

```{r}
skewness(c1)
kurtosis(c1)
```
**ВЫВОД**: Распределение переменной c1 скошено вправо и имеет более легкие хвосты, чем у нормального распределения.

Проверка распределения переменной c1 на нормальность с помощью статистического теста Лиллиефорса

```{r}
library(nortest)
lillie.test(c1)
```
**ВЫВОД**: Гипотеза о нормальном распределении принимается на уровне значимости 0.05.

### Часть 3. Анализ статистических зависимостей

Перекодировать переменную kit так, чтобы она принимала только два значения: 1 и 2
(1 при kit < 3, 2 - в отстальных случаях).

```{r}

```

Вычислить ранговый коэффициент корреляции Спирмена (cor, method = "spearman") для переменных kit и maker. 

```{r}

```

Вывести таблицу сопряженности (table) по переменным kit и maker. Сделать вывод.

```{r}

```

Для переменных c1, c3 вычислить коэффициент корреляции. Сделать вывод. 

```{r}

```

Вывести корреляционную матрицу по всем числовым характеристикам c1-c4 (cor).
Для выбора нужных столбцов таблицы воспользоваться оператором "[]".   

```{r}

```

Представить матрицу корреляции в более удобном виде(symnum, в качестве аргумента
данной функции использовать результат функции cor). Сделать вывод.

```{r}

```

Построить модель линейной регрессии для пары переменных, для которых коэффициент корреляции
имеет наибольшее значение. Использовать функцию lm, зависимая переменная - с меньшим номером.
Полученную модель сохранить в переменную linmod. Вывести общую статистику по модели (summary).
Сделать вывод.

```{r}

```

Построить диаграмму рассеяния (plot) с линией регрессии (abline) для переменных,
которые участвуют в оцененной модели.

```{r}

```

Вывести отдельно коэффициенты модели (coefficients).   

```{r}

```

Сохранить значения остатков (residuals) модели linmod в переменную res.
Построить график "Квантиль-квантиль" (qqnorm) для остатков. Сделать вывод.

```{r}

```

Проверить нормальность остатков с помощью статистического теста Колмогорова-Смирнова (ks.test).  
Сделать вывод.

```{r}

```


### Часть 4. Анализ неоднородных данных

Подсчитать частоты значений для переменной maker (table).  

```{r}

```

Последовательно применить двухвыборочный t-критерий (t.test) к переменным c1, c2, c3, c4. 
Ввборки значений каждой переменной разделяются на две подвыборки по значениям переменной maker (1 или 2).   
Программно получить и вывести результаты (статистику по тесту) по той переменной (c1 / c2 / c3 / c4),
для которой наблюдается значимое (на уровне 0.05) различие средних в двух подвыборках. 
Далее анализировать только выбранную переменную.  

```{r}

```

Построить "ящик с усами" для анализируемой переменной в разрезе по номеру производителя (maker).

```{r}

```

Построить график ядерной оценки плотности распределения (density) для анализируемой переменной. 

```{r}

```


### Часть 5. Классификация неоднородных данных

Построить диаграмму рассеяния (plot) для двух переменных, которые имеют наименьшую корреляцию
(по матрице корреляции из 3 части). Переменная с меньшим номером должна находится по оси Ox.

```{r}

```

Объединить выбранные переменные в одну матрицу (cbind) и сохранить ее в новую переменную.
Вывести первые три строки полученной матрицы (head).

```{r}

```

Выполнить кластерный анализ (kmeans) с разбиением на два класса в пространстве выбранных переменных (kmeans). 
В качестве первого аргумента функции kmeans необходимо передавать матрицу,
а второго - количество классов (2), на которое производится разбиение.   
Сохранить результаты в переменную kmres и вывести частоты наблюдений в каждом оцененном классе (table).

```{r}

```

Вывести график (plot) с легендой (legend), на котором должна быть обозначена классовая принадлежность каждого
наблюдения различными символами (параметр pch).

```{r}

```

Отсоединить таблицу данных qc от списка текущих переменных (работа с данными закончена).

```{r}
detach(qc)
```