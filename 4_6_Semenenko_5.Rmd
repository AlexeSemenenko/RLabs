---
output: html_document
---
#Лабораторный практикум ВКИАД c R

**Преподаватель**
```
Дернакова Оксана Владимировна
```
**Студент**
```
Семененко Алексей Викторович, 2 курс, 6 группа, ПМ
```
**Вариант № 5**


### Часть 1. Управление данными в R

Загрузка данных из текстового файла в таблицу данных

```{r}
qc <- read.table("QC5.txt")
```

Размерность таблицы

```{r}
dim(qc)
```

Первые три записи из таблицы

```{r}
head(qc, 3)
```

Таблица после переименования переменных

```{r}
colnames(qc) <- c("c1", "kit", "nbug", "maker", "vendor", "c2", "c3", "c4", "bug")
head(qc)
```

Комплексная статистика по переменной vendor
 
```{r}
summary(qc$vendor)
```

Комплексная статистика по переменной vendor после ее преобразования в переменную-фактор 

```{r}
qc[, "vendor"] <- as.factor(qc[, "vendor"])
summary(qc[, "vendor"])
```

Число изделий, у которых количество некритических дефектов больше 3

```{r}
sum(qc$nbug > 3)
```

Наблюдения, для которых количество некритических дефектов равно максимальному  

```{r}
qc[qc$nbug == max(qc$nbug),]
```


### Часть 2. Описательная статистика и графический анализ

Присоединение таблицы данных к списку текущих переменных и загрузка дополнительной библиотеки

```{r}
attach(qc)
library("e1071")
```

Выборочные среднее и медиана для переменной с1 в указанном порядке  

```{r}
mean(c1)
median(c1)
```

Выборочные квартили Q1,Q2,Q3, а также интерквартильный размах для переменной c1
 
```{r}
quantile(c1, probs = c(0.25, 0.5, 0.75))
IQR(c1)
```

Комплексная статистика по переменной c1

```{r}
summary(c1)
```

Дисперсия для переменной с1 и переменной 2 * с1 + 100

```{r}
var(c1)
var(2 * c1 + 100)
```
**ВЫВОД**: Вторая дисперсия больше первой в 4 раза

Дисперсия для переменной с1, полученная с помощью векторного выражения

```{r}
sum(mean(c1 * c1) - (mean(c1))^2) * length(c1) / (length(c1) - 1)
```

Гистограмма для переменной с1   

```{r}
hist(c1)
```

Асимметрия и эксцесс для переменной c1 в указанном порядке 

```{r}
skewness(c1)
kurtosis(c1)
```
**ВЫВОД**: Распределение переменной c1 скошено вправо и имеет более легкие хвосты, чем у нормального распределения.

Проверка распределения переменной c1 на нормальность с помощью статистического теста Лиллиефорса

```{r}
library(nortest)
lillie.test(c1)
```
**ВЫВОД**: Гипотеза о нормальном распределении принимается на уровне значимости 0.05.

### Часть 3. Анализ статистических зависимостей

Перекодирование переменной kit в переменную с двумя значениями (1 и 2)

```{r}
kit <- ifelse(kit < 3, 1, 2)
```

Ранговый коэффициент корреляции Спирмена для переменных kit и maker 

```{r}
cor(kit, maker, method = "spearman")
```

Таблица сопряженности для переменных kit и maker

```{r}
table(kit, maker)
```
**ВЫВОД**:  Согласно ранговому коэффициенту корреляции и таблице сопряженности согласованность между переменными практически отсутствует.

Тест на равенство нулю коэффициента корреляции для переменных с1 и с3

```{r}
cor.test(c1, c3)
```
**ВЫВОД**: Гипотеза о равенстве нулю коэффициента корреляции между переменными отклоняется на уровне значимости 0.05.

Корреляционная матрица для числовых характеристик с1-c4

```{r}
mCor = cor(qc[, c(1, 6:8)])
mCor
```

Матрица корреляции в удобном представлении

```{r}
symnum(mCor)
```
**ВЫВОД**: Наибольший коэффициент корреляции наблюдается между переменными c3 и c4.

Построение регрессионной модели по переменным c3 (зависимая - отклик) и c4(независимая - фактор) и вывод общей статистики по результатам оценивания

```{r}
summary(linmod <- lm(c3 ~ c4))
```
**ВЫВОД**: Значим (на уровне 0.05) только коэффицент при независимой переменной с4. Статистика R-квадрат принимает значение 0.7657.

Диаграмма рассеяния с линией регрессии для переменных c3 и c4.

```{r}
plot(c3 ~ c4)
abline(linmod)
```

Коэффициенты регрессионной модели   

```{r}
coefficients(linmod)
```

График “Квантиль-квантиль” для остатков модели

```{r}
res = residuals(linmod)
qqnorm(res)
```

**ВЫВОД**: Большинство точек располагаются вблизи прямой линии, поэтому распределение остатков близко к нормальному.

Тест Колмогорова-Смирнова на нормальность остатков

```{r}
ks.test(res, pnorm, mean(res), sd(res))
```
**ВЫВОД**: Критерий принимает гипотезу о нормальном распределении остатков на уровне значимости 0.05.

### Часть 4. Анализ неоднородных данных

Частоты значений для переменной maker.

```{r}
table(maker)
```

Двухвыборочный t-критерий по переменной, для которой наблюдается значимое различие средних в двух подвыборках (по значениям переменной maker), c разбиением на подвыборки по переменной maker.

```{r}
tc1 = t.test(c1 ~ maker)
tc2 = t.test(c2 ~ maker)
tc3 = t.test(c3 ~ maker)
tc4 = t.test(c4 ~ maker)
min = min(c(tc1$p.value, tc2$p.value, tc3$p.value, tc4$p.value))
if (tc1$p.value == min) tc1
if (tc2$p.value == min) tc2
if (tc3$p.value == min) tc3
if (tc4$p.value == min) tc4
```
**ВЫВОД**: Гипотеза о равенстве средних в двух подвыборках отклоняется на уровне значимости 0.05 для переменной c2 (средние значения характеристики c2 у двух производителей статистически различимы).

Построить "ящик с усами" для анализируемой переменной в разрезе по номеру производителя (maker).

```{r}
boxplot(c2~maker)
```

Построить график ядерной оценки плотности распределения (density) для анализируемой переменной. 

```{r}
plot(density(c2))
```
**ВЫВОД**: Из графика видно, что выборка описывается моделью, которая представляет собой смесь двух распределений.

### Часть 5. Классификация неоднородных данных

Построить диаграмму рассеяния (plot) для двух переменных, которые имеют наименьшую корреляцию
(по матрице корреляции из 3 части). Переменная с меньшим номером должна находится по оси Ox.

```{r}

```

Объединить выбранные переменные в одну матрицу (cbind) и сохранить ее в новую переменную.
Вывести первые три строки полученной матрицы (head).

```{r}

```

Выполнить кластерный анализ (kmeans) с разбиением на два класса в пространстве выбранных переменных (kmeans). 
В качестве первого аргумента функции kmeans необходимо передавать матрицу,
а второго - количество классов (2), на которое производится разбиение.   
Сохранить результаты в переменную kmres и вывести частоты наблюдений в каждом оцененном классе (table).

```{r}

```

Вывести график (plot) с легендой (legend), на котором должна быть обозначена классовая принадлежность каждого
наблюдения различными символами (параметр pch).

```{r}

```

Отсоединить таблицу данных qc от списка текущих переменных (работа с данными закончена).

```{r}
detach(qc)
```